<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Neurolinguistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./index.html">Syllabus</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Neurolinguistics</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Syllabus</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html#resources" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resources</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html#final-paper" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Final paper</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html#schedule" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    <div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="index.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Neurolinguistics</h1>
<p class="subtitle lead">Fall 2024</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Welcome to Neurolinguistics! The Fall 2024 course information and materials are below. Course materials from previous semesters are archived <a href="./archive.html">here</a>.</p>
<section id="syllabus" class="level2">
<h2 class="anchored" data-anchor-id="syllabus">Syllabus</h2>
<p><strong>Course Description</strong>: Neurolinguistics is a seminar on language and the brain. For the first few weeks, you will build a foundation of knowledge, first on how brains work (neurons, networks, and anatomy) and later on the methods researchers use to study language in the brain. The remainder of the course will explore the literature on different topics in language and the brain, including various levels of linguistics (phonology, morphology, syntax), acquisition, evolution, signed languages, and more.</p>
<p><strong>Prerequisites</strong>: This course is open to all graduate students and upper-level undergraduates. No specific background in neuroscience or linguistics is necessary to participate in the course. However, this is an advanced seminar-style course; students looking for a lecture formart will not enjoy this course.</p>
<p><strong>Instructor</strong>: <a href="https://kathrynschuler.com">Dr.&nbsp;Katie Schuler (she/her)</a></p>
<ul>
<li>You can call me <strong>Katie</strong></li>
</ul>
<p><strong>Seminars</strong>: Thursday at 1:45pm in TBD</p>
<p><strong>Office Hours</strong>: The linguistics department is located on the 3rd floor of 3401-C Walnut street, between Franklin’s Table and Modern Eye.</p>
<ul>
<li>Katie Schuler: TBD in 314C</li>
</ul>
<p><strong>Requirements</strong>: This is an advanced STEM seminar. Below are the major requiements, but please read the <a href="./tips.html">tips for seminars</a> to understand further:</p>
<ul>
<li><strong>Reading prep</strong>: Each week, you will be responsible for preparing for the discussion by completing the assigned reading. As you read, you are responsible for asking questions and beginning the discussion of the paper in our reading annotation tool, Perusall.</li>
<li><strong>Discussion leader</strong>: Several times throughout the semester (but not every week), you will serve as discussion leader for a paper with one or two other students. As discussion leader, your group will be responsible for presenting the paper, including summarizing (motivation, research questions, approach, and findings) and leading a discussion of the work.</li>
<li><strong>Final paper</strong>: You will select a paper of interest to you (within the bounds of language and the brain) and write a research analysis of the work (in the form of a nature “News &amp; Views” paper; example <a href="https://www.nature.com/articles/d41586-024-02525-z">here</a>). There are a few checkpoints leading up to this final paper (including peer review) to help you make progress.</li>
</ul>
<p><strong>Grading</strong>:</p>
<ul>
<li>30% Participation in discussion (including reading prep in Perusall)</li>
<li>40% Discussion leader</li>
<li>30% Final paper (including several check-points throughout the semester: paper selection, outline, drafts, and peer review)</li>
</ul>
<p><strong>Extensions</strong>: For assignments related to the final paper, extensions of up to 1 week will be granted for any reason. Beyond that, you can turn in any missed writing assignement for half-credit (50%).</p>
<p><strong>Accomodations</strong>: I will support any accommodations arranged through Disability Services via the <a href="https://weingartencenter.universitylife.upenn.edu/disability-services/">Weingarten Center</a> and to make alternate arrangements when class conflicts with a religious holiday. Please notify me as soon as possible if you require accomodations.</p>
<p><strong>Extra credit</strong>: There is no extra credit in the course. However, students can submit any missed reading prep by the end of the semester for half credit (50%). To ensure fair treatment, all students will receive a 1% “bonus” to their final course grade: 92.54% will become 93.54%.</p>
<p><strong>Support</strong>: Asking for help is a sign of strength! I hope you’ll reach out to me if you need help (acamdeically or otherwise). I also want you to be aware of Penn’s Academic &amp; Wellness Resources</p>
</section>
<section id="resources" class="level2">
<h2 class="anchored" data-anchor-id="resources">Resources</h2>
<p>In addition to our course website, we will use the following:</p>
<ul>
<li><a href="https://canvas.upenn.edu/courses/1809307">canvas</a>- for posting grades</li>
<li><a href="https://app.perusall.com/courses/ling-3740-402-5740-401-202430-neurolinguistics/_/dashboard/assignments/6wi5gos5PnxApBjyA">perusall</a> - for reading annotations</li>
<li><a href="https://edstem.org/us/courses/65316/discussion/">ed discussion</a> - for announcements and questions</li>
</ul>
<p>Other helpful materials and resources:</p>
<ul>
<li><a href="./tips.html">tips for seminars</a></li>
</ul>
<p>Please consider using these Penn resources this semester:</p>
<ul>
<li><a href="https://weingartencenter.universitylife.upenn.edu/academic-support/">Weingarten Center</a> for academic support and tutoring.</li>
<li><a href="https://wellness.upenn.edu/">Wellness at Penn</a> for health and wellbeing.</li>
</ul>
</section>
<section id="final-paper" class="level2">
<h2 class="anchored" data-anchor-id="final-paper">Final paper</h2>
<p>There are 7 checkpoints leading up to (and including) the final paper, due on the following Mondays at noon. Extensions of up to 1 week will be granted for any reason. Beyond that, you can turn in any missed checkpoint for half-credit (50%) by the end of the semester.</p>
<ul>
<li><a href="./final_paper/checkpoint-1.html">Checkpoint 1: Topic selection due Sep 23</a></li>
<li><a href="./final_paper/checkpoint-2.html">Checkpoint 2: Outline due Oct 7</a></li>
<li><a href="./final_paper/checkpoint-3.html">Checkpoint 3: Peer review 1 due Oct 21</a></li>
<li><a href="./final_paper/checkpoint-4.html">Checkpoint 4: Revised outline due Nov 4</a></li>
<li><a href="./final_paper/checkpoint-5.html">Checkpoint 5: Paper draft due Nov 21</a></li>
<li><a href="./final_paper/checkpoint-6.html">Checkpoint 6: Peer review 2 due Dec 5</a></li>
<li><a href="./final_paper/checkpoint-7.html">Checkpoint 7: Final paper due Dec 16</a></li>
</ul>
</section>
<section id="schedule" class="level2">
<h2 class="anchored" data-anchor-id="schedule">Schedule</h2>
<div class="callout callout-style-default callout-warning callout-titled" title="Under Construction">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Under Construction
</div>
</div>
<div class="callout-body-container callout-body">
<p>This is the first draft of the schedule. You should see your name 3 times, mostly on topics you expressed an interest in.</p>
</div>
</div>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Week</th>
<th>Date</th>
<th>Topic &amp; Discussion Leaders</th>
<th>Due</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Aug 29</td>
<td><a href="./getting-started.html">Getting started</a> <br> Katie (Instructor)</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>2</td>
<td>Sep 5</td>
<td><a href="./cns-neurons-methods.html">CNS, neurons, and methods</a> <br> Katie (Instructor)</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>3</td>
<td>Sep 12</td>
<td><strong>Perspective</strong> <br> Krakauer et al (2017): Chloe, Dillon, Erica <br> Embick &amp; Poeppel (2015): Esther, Mahir, Sophia</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>4</td>
<td>Sep 19</td>
<td><strong>Networks</strong> <br> Esther, Jo, Na, Mahir, Sophia, Jaehyuk</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>5</td>
<td>Sep 26</td>
<td><strong>Phonemes &amp; Syntax</strong> <br> Daniel, Dillon, Greg, Ninjin, Tali</td>
<td><a href="./final_paper/checkpoint-1.html">CP1 Topic selection (due 9/23)</a></td>
<td></td>
</tr>
<tr class="even">
<td>6</td>
<td>Oct 3</td>
<td><strong>Fall break (no class)</strong></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>7</td>
<td>Oct 10</td>
<td><strong>Acquisition I</strong> <br> Carey, Leann, Katie, Karis, Ninjin, Tali, Tess, Na</td>
<td><a href="./final_paper/checkpoint-2.html">CP2 Outline (due 10/7)</a></td>
<td></td>
</tr>
<tr class="even">
<td>8</td>
<td>Oct 17</td>
<td><strong>No class (Katie @ conference)</strong></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>9</td>
<td>Oct 24</td>
<td><strong>Acquisition II</strong> <br> Alyssa, Chloe, Daniel, Dillon, Esther, Greg, Jo, Kamelija</td>
<td><a href="./final_paper/3">CP3 Peer review 1 (due 10/21)</a></td>
<td></td>
</tr>
<tr class="even">
<td>10</td>
<td>Oct 31</td>
<td><strong>Bilingualism I</strong> <br> Alyssa, Erica, Kamelija, Sophia, Daniel, Greg</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>11</td>
<td>Nov 7</td>
<td><strong>Symposium (Zoom):</strong><br><strong>Neural Coding in Speech, Language and Cognition</strong></td>
<td><a href="./final_paper/checkpoint-4.html">CP4 Revised outline (due 11/4)</a></td>
<td></td>
</tr>
<tr class="even">
<td>12</td>
<td>Nov 14</td>
<td><strong>Bilingualism II</strong> <br> Carey, Chloe, Leann, Katie, Na, Karis, Jo</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>13</td>
<td>Nov 21</td>
<td><strong>Sign language</strong> <br> Carey, Leann, Katie, Karis, Tali, Tess, Jaehyuk</td>
<td><a href="./final_paper/checkpoint-5.html">CP5 Paper draft (due 11/21)</a></td>
<td></td>
</tr>
<tr class="even">
<td>14</td>
<td>Nov 28</td>
<td><strong>Thanksgiving break (no class)</strong></td>
<td>Peer Review II (Tues)</td>
<td></td>
</tr>
<tr class="odd">
<td>15</td>
<td>Dec 5</td>
<td><strong>Evolution</strong> <br> Alyssa, Erica, Ninjin, Kamelija, Tess, Mahir</td>
<td><a href="./final_paper/checkpoint-6.html">CP6 Peer review 2 (due 12/5)</a></td>
<td></td>
</tr>
<tr class="even">
<td>16</td>
<td>Dec 9</td>
<td>No class</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>17</td>
<td></td>
<td><a href="./final_paper/checkpoint-7.html">CP7 Final paper (due 12/16)</a></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>